pkgname='iosevka-custom'
pkgver=1.1.1
pkgrel=2
arch=(any)

provides=('ttf-font')
url="https://typeof.net/Iosevka/"
license=('OFL')
makedepends=('nodejs>=14.0.0')
source=('private-build-plans.toml'
        "OFL.txt")

b2sums=('7d53b9084b7182dd3e26980d5063804fb165d2038a35e751b8ff0febc4f9d9af9e5498ba835ebde5ac971244c869d7f94e96387ad2ee247a0ee148218722ca72'
        '7b4b0426b38d403dd0111971c71db6d6e7fa34a9176fa91578479790e6bdcaea68a91af08223e0124edf49432848cd844696ceda9b3647ab56ec546386a65d0c')

prepare() {
    pwd
    git clone --depth=1 https://github.com/be5invis/Iosevka.git "${pkgname}"
    mv -t "./${pkgname}" ./private-build-plans.toml
    cd "${pkgname}"
    npm install
}

build() {
    pwd
    cd "${pkgname}"
    npm run build -- contents::iosevka-custom --jCmd=4
}

package() {
    pwd
    install -Dm644 -t "${pkgdir}/usr/share/fonts/TTF" ${pkgname}/dist/${pkgname}/ttf/*.ttf
    fc-cache
    install -d "${pkgdir}/usr/share/licenses/${pkgname}"
    install -Dm644 -t "${pkgdir}/usr/share/licenses/${pkgname}" "OFL.txt"
}
